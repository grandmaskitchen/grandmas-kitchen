<button id="fetchAmazon" type="button">Fetch from Amazon</button>
<script>
document.getElementById('fetchAmazon').addEventListener('click', async () => {
  const urlOrAsin = document.querySelector('[name="affiliate_link"]').value.trim();
  if (!urlOrAsin) return alert("Paste an Amazon URL or ASIN first.");

  const r = await fetch('/api/amazon-fetch', {
    method:'POST',
    headers:{ 'Content-Type':'application/json' },
    body: JSON.stringify({ urlOrAsin })
  });
  if (!r.ok) return alert('Fetch failed');
  const { scraped } = await r.json();

  // Pre-fill your fields (you can tweak this mapping)
  const set = (name, val) => { const el = document.querySelector(`[name="${name}"]`); if (el && !el.value) el.value = val || ''; }
  set('amazon_title', scraped.amazon_title);
  set('amazon_desc', scraped.amazon_desc);
  set('image_main', scraped.image_main);
  set('image_small', scraped.image_small);
  set('amazon_category', scraped.amazon_category);
  // keep your own affiliate_link value if you prefer amzn.to; otherwise:
  if (!document.querySelector('[name="affiliate_link"]').value) set('affiliate_link', scraped.affiliate_link);
});
</script>
