<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Grandma’s Kitchen</title>

  <link rel="alternate" type="application/rss+xml"
        title="Grandma’s Kitchen • Daily Picks"
        href="/app/home-picks.rss" />

  <link rel="preload" href="/style.css" as="style">
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  ...
  <section class="container" aria-labelledby="daily-picks-title">
    <h2 id="daily-picks-title">Today’s Picks</h2>
    <div id="homePicks" class="grid grid-2">
      <article class="card"><div class="skeleton img"></div><div class="skeleton text" style="width:70%"></div></article>
      <article class="card"><div class="skeleton img"></div><div class="skeleton text" style="width:60%"></div></article>
    </div>
  </section>

  <script>
  (async function () {
    const box = document.getElementById('homePicks');
    if (!box) return;

    const esc = s => (s||'').replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[m]));

    try {
      const r = await fetch('/api/home-picks');    // ← FIXED
      const { items, error } = await r.json();
      if (!r.ok || !Array.isArray(items)) throw new Error(error || 'Failed to load');

      if (!items.length) {
        box.innerHTML = `<p class="muted">No picks yet.</p>`;
        return;
      }

      box.innerHTML = items.map(p => {
        const title = p.my_title || p.amazon_title || 'Product';
        const slug  = p.product_num || '';
        const url   = `/products/${encodeURIComponent(slug)}`;
        const img   = p.image_main || '';
        const blurb = p.my_description_short || '';
        return `
          <article class="card" aria-labelledby="pick-${esc(slug)}">
            <a class="product-image" href="${esc(url)}">
              ${img ? `<img loading="lazy" decoding="async" src="${esc(img)}" alt="${esc(title)}">` : ''}
            </a>
            <h3 id="pick-${esc(slug)}" class="product-title">
              <a href="${esc(url)}">${esc(title)}</a>
            </h3>
            ${blurb ? `<p class="muted">${esc(blurb)}</p>` : ''}
            <p><a class="btn" href="${esc(url)}">View product</a></p>
          </article>
        `;
      }).join('');
    } catch (err) {
      console.error(err);
      box.innerHTML = `<p class="muted">Sorry, today’s picks are unavailable.</p>`;
    }
  })();
  </script>
</body>
</html>
